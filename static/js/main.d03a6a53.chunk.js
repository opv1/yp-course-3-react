(this["webpackJsonpyp-course-3-react"]=this["webpackJsonpyp-course-3-react"]||[]).push([[0],{10:function(e,t,a){e.exports={Header:"Header_Header__1e_0U",Logo:"Header_Logo__NfVY3"}},11:function(e,t,a){e.exports={Form:"Form_Form__3yARy",Avatar:"Form_Avatar__2B2kZ",Edit:"Form_Edit__32yl-",Add:"Form_Add__3j5Xp"}},12:function(e,t,a){e.exports={Input:"Input_Input__3F9VC"}},14:function(e,t,a){e.exports={Loader:"Loader_Loader__3BDOx",Loading:"Loader_Loading__ROe3I"}},26:function(e,t,a){e.exports={Layout:"Layout_Layout__UlWYS"}},27:function(e,t,a){e.exports=a.p+"static/media/logo.aa3e7ad2.svg"},28:function(e,t,a){e.exports={CardList:"CardList_CardList__2XYjU"}},29:function(e,t,a){e.exports=a.p+"static/media/close.41450a58.svg"},3:function(e,t,a){e.exports={Modal:"Modal_Modal__3rlzY",Avatar:"Modal_Avatar__2ZnfD",Edit:"Modal_Edit__21zij",Add:"Modal_Add__CJUPK",Image:"Modal_Image__3j_hZ",Content:"Modal_Content__oz8Ki",ContentImage:"Modal_ContentImage__25Si7",Close:"Modal_Close__2oB51",Title:"Modal_Title__2814I"}},30:function(e,t,a){e.exports={Error:"Error_Error__3ieBZ"}},35:function(e,t,a){e.exports=a(60)},4:function(e,t,a){e.exports={Profile:"Profile_Profile__3d3Um",Info:"Profile_Info__2i-TL",Data:"Profile_Data__1dvf4",Job:"Profile_Job__2wt8s",Name:"Profile_Name__2CKgv",Avatar:"Profile_Avatar__2gqkF"}},41:function(e,t,a){},5:function(e,t,a){e.exports={Card:"Card_Card__1-aIe",Image:"Card_Image__3zHVY",Description:"Card_Description__FtNuI",Name:"Card_Name__2GIPN",Like:"Card_Like__1BR3H",LikeCounter:"Card_LikeCounter__1LEyD"}},60:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),l=a.n(o),c=a(9),i=a.n(c),u=a(1),d=a(24),s=a(6),m=(a(41),Object(n.createContext)()),f=a(25),_=a.n(f).a.create({baseURL:"https://praktikum.tk/cohort8",headers:{authorization:"7563ceef-3fab-429e-abe8-149027f36882","Content-Type":"application/json"}}),v=a(26),p=a.n(v);var h=function(e){var t=e.children;return r.a.createElement("div",{className:p.a.Layout},t)},g=a(10),b=a.n(g),C=a(27),k=a.n(C);var E=function(){return r.a.createElement("header",{className:b.a.Header},r.a.createElement("img",{src:k.a,alt:"Logo",className:b.a.Logo}))},y=a(4),j=a.n(y),I=a(7),O=a.n(I),L=function(e){var t=e.onClick,a=e.type,n=e.disabled,o=e.activateLike,l=e.showDeleteIcon,c=e.children,i=[O.a.Button,O.a[a]];return n&&i.push(O.a.Disabled),o&&i.push(O.a.ActiveLikeIcon),l&&i.push(O.a.DisplayBlock),r.a.createElement("button",{onClick:t,className:i.join(" "),name:"button",disabled:n},c)};var M=function(e){var t=e.userInfo,a=Object(n.useContext)(m).handleShowModal,o={backgroundImage:"url('".concat(t.avatar,"')")};return r.a.createElement("div",{className:j.a.Profile},r.a.createElement("div",{className:j.a.Info},r.a.createElement("div",{className:j.a.Avatar,onClick:a,style:o}),r.a.createElement("div",{className:j.a.Data},r.a.createElement("h1",{className:j.a.Name},t.name),r.a.createElement("p",{className:j.a.Job},t.about),r.a.createElement(L,{type:"Edit",onClick:a},"edit")),r.a.createElement(L,{type:"Add",onClick:a},"+")))},N=a(28),x=a.n(N),A=a(5),w=a.n(A);var B=function(e){var t=e.myId,a=e.children,o=Object(n.useState)({showDeleteIcon:!1,activateLike:!1,likeCounter:null}),l=Object(s.a)(o,2),c=l[0],i=l[1];Object(n.useEffect)((function(){a.owner._id===t&&i((function(e){return Object(u.a)(Object(u.a)({},e),{},{showDeleteIcon:!0})})),a.likes.forEach((function(e){e._id===t&&i((function(e){return Object(u.a)(Object(u.a)({},e),{},{activateLike:!0})}))})),i((function(e){return Object(u.a)(Object(u.a)({},e),{},{likeCounter:a.likes.length})}))}),[]);var d=Object(n.useContext)(m),f=d.handleShowModal,v=d.handleRemoveCard,p={backgroundImage:"url('".concat(a.link,"')")};return r.a.createElement("div",{className:w.a.Card,data:a._id},r.a.createElement("div",{onClick:f,className:w.a.Image,style:p},r.a.createElement(L,{onClick:function(e){return v(e,a._id)},type:"DeleteIcon",showDeleteIcon:c.showDeleteIcon})),r.a.createElement("div",{className:w.a.Description},r.a.createElement("h3",{className:w.a.Name},a.name),r.a.createElement("div",{className:w.a.Like},r.a.createElement(L,{onClick:function(e){return function(e){var t=e.target.closest(".Card_Card__1-aIe").getAttribute("data");e.target.closest(".Button_LikeIcon__2q2NK").classList.contains("Button_ActiveLikeIcon__1dC21")?_.delete("/cards/like/".concat(t)).then((function(){return i((function(e){return Object(u.a)(Object(u.a)({},e),{},{activateLike:!1,likeCounter:e.likeCounter-1})}))})).catch((function(e){return console.log(e)})):_.put("/cards/like/".concat(t)).then((function(){return i((function(e){return Object(u.a)(Object(u.a)({},e),{},{activateLike:!0,likeCounter:e.likeCounter+1})}))})).catch((function(e){return console.log(e)}))}(e)},type:"LikeIcon",activateLike:c.activateLike}),r.a.createElement("span",{className:w.a.LikeCounter},c.likeCounter))))};var F=function(e){var t=e.initialCards,a=e.myId;return r.a.createElement("div",{className:x.a.CardList},t.map((function(e){return r.a.createElement(B,{key:e._id,myId:a},e)})))},D=a(3),P=a.n(D),S=a(29),q=a.n(S),V=function(e){return e.children},H=a(11),U=a.n(H),T=function(e){var t=e.onSubmit,a=e.type,n=e.name,o=e.style,l=e.children,c=[U.a.Form,U.a[a]];return r.a.createElement("form",{onSubmit:t,className:c.join(" "),name:n,style:o,noValidate:!0},l)},Z=a(12),z=a.n(Z),J=function(e){var t=e.onChange,a=e.value,n=e.type,o=e.name,l=e.placeholder,c=e.valid,i=e.validation,u=[z.a.Input];return c||u.push(z.a.invalid),r.a.createElement("input",{onChange:t,className:u.join(" "),value:a,type:n||"text",name:o,placeholder:l,minLength:i.minLength,maxLength:i.maxLength,required:!0})},R=a(30),Y=a.n(R),K=function(e){var t=e.errorMessage;return r.a.createElement("span",{className:Y.a.Error},t)},X=a(13),W=a.n(X);function Q(e,t){return Object(u.a)(Object(u.a)({},e),{},{touched:!1,validation:t,valid:$(e.value,t),errorMessage:ee(e.value,t,!0)})}function G(e){var t=!0;for(var a in e)e.hasOwnProperty(a)&&(t=e[a].valid&&t);return t}function $(e,t){if(!t)return!0;var a=!0;return t.required&&(a=""!==e.trim()&&a),t.minLength&&(a=e.length>=t.minLength&&a),t.url&&(a=W.a.url(e)&&a),a}function ee(e,t,a){return a?"":0===e.length?"\u042d\u0442\u043e \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435":e.length<t.minLength?"\u0414\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043e\u0442 2 \u0434\u043e 30 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432":!W.a.url(e)&&"\u0417\u0434\u0435\u0441\u044c \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0430"}var te=function(e){var t=e.userInfo,a=e.typeModal,o=e.backgroundImage,l=Object(n.useState)({modalConfig:{},formControls:{},isFormValid:!1}),c=Object(s.a)(l,2),i=c[0],d=c[1];Object(n.useEffect)((function(){"Avatar"===a&&d((function(e){return Object(u.a)(Object(u.a)({},e),{},{modalConfig:{nameModal:"\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",typeForm:"Avatar",nameFrom:"avatar",nameButton:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},formControls:{avatar:Q({value:"",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440"},{url:!0,required:!0})}})})),"Edit"===a&&d((function(e){return Object(u.a)(Object(u.a)({},e),{},{modalConfig:{nameModal:"\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",typeForm:"Edit",nameFrom:"edit",nameButton:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},formControls:{name:Q({value:t.name,type:"text",name:"name",placeholder:"\u0418\u043c\u044f"},{minLength:2,maxLength:30,required:!0}),info:Q({value:t.about,type:"text",name:"info",placeholder:"\u041e \u0441\u0435\u0431\u0435"},{minLength:2,maxLength:30,required:!0})},isFormValid:G(i.formControls)})})),"Add"===a&&d((function(e){return Object(u.a)(Object(u.a)({},e),{},{modalConfig:{nameModal:"\u043d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",typeForm:"Add",nameFrom:"add",nameButton:"+"},formControls:{name:Q({value:"",type:"text",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"},{minLength:2,maxLength:30,required:!0}),link:Q({value:"",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"},{url:!0,required:!0})}})}))}),[]);var f=Object(n.useContext)(m),_=f.handleShowModal,v=f.handleSubmit,p=i.modalConfig,h=p.nameModal,g=p.typeForm,b=p.nameFrom,C=p.nameButton,k=[P.a.Modal,P.a[a]];return r.a.createElement("div",{className:k.join(" ")},r.a.createElement("div",{className:"Image"===a?(P.a.Content,P.a.ContentImage):P.a.Content,style:"Image"===a?o:null},r.a.createElement("img",{onClick:_,src:q.a,alt:"Close",className:P.a.Close}),r.a.createElement("h3",{className:P.a.Title,style:"Image"===a?{display:"none"}:null},h),r.a.createElement(T,{onSubmit:v,type:g,name:b,style:"Image"===a?{display:"none"}:null},Object.keys(i.formControls).map((function(e,t){var a=i.formControls[e];return r.a.createElement(V,{key:t+1},r.a.createElement(J,{onChange:function(t){return function(e,t){var a=Object(u.a)({},i.formControls),n=Object(u.a)({},a[t]);n.value=e.target.value,n.touched=!0,n.valid=$(n.value,n.validation),n.errorMessage=ee(n.value,n.validation),a[t]=n;var r=G(a);d((function(e){return Object(u.a)(Object(u.a)({},e),{},{formControls:a,isFormValid:r})}))}(t,e)},value:a.value,type:a.type,name:a.name,placeholder:a.placeholder,valid:a.valid,validation:a.validation}),a.valid?null:r.a.createElement(K,{errorMessage:a.errorMessage}))})),r.a.createElement(L,{type:"Popup",disabled:!i.isFormValid},C))))},ae=a(14),ne=a.n(ae),re=function(){return r.a.createElement("div",{className:ne.a.Loader},r.a.createElement("div",{className:ne.a.Loading},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)))},oe=a(31),le=a(32),ce=a(34),ie=a(33),ue=function(e){Object(ce.a)(a,e);var t=Object(ie.a)(a);function a(){var e;Object(oe.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).el=document.createElement("div"),e}return Object(le.a)(a,[{key:"componentDidMount",value:function(){document.body.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.el)}},{key:"render",value:function(){return l.a.createPortal(this.props.children,this.el)}}]),a}(r.a.Component);var de=function(){var e=Object(n.useState)({loading:!0,showModal:!1,myId:"24ee49f7ef633fcc99f70066",userInfo:{},initialCards:[],typeModal:null,backgroundImage:null}),t=Object(s.a)(e,2),a=t[0],o=t[1];Object(n.useEffect)((function(){(function(){var e=Object(d.a)(i.a.mark((function e(){var t,n,r,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.get("/users/me/");case 3:return t=e.sent,e.next=6,_.get("/cards/");case 6:for(n=e.sent,r=[],l=0;n.data.length>l;l++)n.data[l].owner._id===a.myId&&r.push(n.data[l]);o((function(e){return Object(u.a)(Object(u.a)({},e),{},{loading:!1,userInfo:t.data,initialCards:r})})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}})()()}),[]);var l=function(){o((function(e){return Object(u.a)(Object(u.a)({},e),{},{showModal:!e.showModal})}))};return r.a.createElement(m.Provider,{value:{handleShowModal:l,handleSubmit:function(e){e.preventDefault();var t=e.target,n=e.target.elements.button;e.target.closest(".Form_Avatar__2B2kZ")&&new Promise((function(e){n.textContent="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",e(_.patch("/users/me/avatar/",{avatar:t.elements.link.value}))})).then((function(){return o((function(e){return Object(u.a)(Object(u.a)({},e),{},{userInfo:Object(u.a)(Object(u.a)({},e.userInfo),{},{avatar:t.elements.link.value})})}))})).then((function(){return l()})).catch((function(e){return console.log(e)}));e.target.closest(".Form_Edit__32yl-")&&new Promise((function(e){n.textContent="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",e(_.patch("/users/me/",{name:t.elements.name.value,about:t.elements.info.value}))})).then((function(){return o((function(e){return Object(u.a)(Object(u.a)({},e),{},{userInfo:Object(u.a)(Object(u.a)({},e.userInfo),{},{name:t.elements.name.value,about:t.elements.info.value})})}))})).then((function(){return l()})).catch((function(e){return console.log(e)}));e.target.closest(".Form_Add__3j5Xp")&&new Promise((function(e){n.textContent="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",e(_.post("/cards/",{name:t.elements.name.value,link:t.elements.link.value}))})).then((function(e){return o((function(t){return Object(u.a)(Object(u.a)({},t),{},{initialCards:a.initialCards.concat(e.data)})}))})).then((function(){return l()})).catch((function(e){return console.log(e)}))},handleRemoveCard:function(e,t){e.stopPropagation();var n=a.initialCards.filter((function(e){return e._id!==t}));_.delete("/cards/".concat(t,"/")).then((function(){return o((function(e){return Object(u.a)(Object(u.a)({},e),{},{initialCards:n})}))})).catch((function(e){return console.log(e)}))}}},r.a.createElement(h,null,r.a.createElement(E,null),a.loading?r.a.createElement(re,null):r.a.createElement("main",{onClick:function(e){return function(e){if(e.target.closest(".Profile_Avatar__2gqkF")&&o((function(e){return Object(u.a)(Object(u.a)({},e),{},{typeModal:"Avatar"})})),e.target.closest(".Button_Edit__2mjyM")&&o((function(e){return Object(u.a)(Object(u.a)({},e),{},{typeModal:"Edit"})})),e.target.closest(".Button_Add__pQA0V")&&o((function(e){return Object(u.a)(Object(u.a)({},e),{},{typeModal:"Add"})})),e.target.closest(".Card_Image__3zHVY")){var t={backgroundImage:e.target.style.backgroundImage};o((function(e){return Object(u.a)(Object(u.a)({},e),{},{typeModal:"Image",backgroundImage:t})}))}}(e)}},r.a.createElement(M,{userInfo:a.userInfo}),r.a.createElement(F,{myId:a.myId,initialCards:a.initialCards})),a.showModal?r.a.createElement(ue,null,r.a.createElement(te,{userInfo:a.userInfo,typeModal:a.typeModal,backgroundImage:a.backgroundImage})):null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,a){e.exports={Button:"Button_Button__ZCo3y",Edit:"Button_Edit__2mjyM",Add:"Button_Add__pQA0V",Popup:"Button_Popup__1lTX4",DeleteIcon:"Button_DeleteIcon__Cx1UT",LikeIcon:"Button_LikeIcon__2q2NK",ActiveLikeIcon:"Button_ActiveLikeIcon__1dC21",Disabled:"Button_Disabled__QrPOn",DisplayBlock:"Button_DisplayBlock__6ZmXd"}}},[[35,1,2]]]);
//# sourceMappingURL=main.d03a6a53.chunk.js.map
(this["webpackJsonpyp-course-3-react"]=this["webpackJsonpyp-course-3-react"]||[]).push([[0],{10:function(e,t,a){e.exports={Button:"Button_Button__ZCo3y",Edit:"Button_Edit__2mjyM",Add:"Button_Add__pQA0V",Popup:"Button_Popup__1lTX4",DeleteIcon:"Button_DeleteIcon__Cx1UT",LikeIcon:"Button_LikeIcon__2q2NK",ActiveLikeIcon:"Button_ActiveLikeIcon__1dC21",Disabled:"Button_Disabled__QrPOn",DisplayBlock:"Button_DisplayBlock__6ZmXd"}},12:function(e,t,a){e.exports={Input:"Input_Input__3F9VC",Error:"Input_Error__2cNrs"}},14:function(e,t,a){e.exports={Form:"Form_Form__3yARy",Avatar:"Form_Avatar__2B2kZ",Edit:"Form_Edit__32yl-",Add:"Form_Add__3j5Xp"}},15:function(e,t,a){e.exports={Header:"Header_Header__1e_0U",Logo:"Header_Logo__NfVY3"}},26:function(e,t,a){e.exports={Layout:"Layout_Layout__UlWYS"}},28:function(e,t,a){e.exports=a.p+"static/media/close.41450a58.svg"},29:function(e,t,a){e.exports=a.p+"static/media/logo.aa3e7ad2.svg"},30:function(e,t,a){e.exports={CardList:"CardList_CardList__2XYjU"}},31:function(e,t,a){e.exports=a(55)},36:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(11),i=a.n(r),l=(a(36),a(13)),s=a.n(l),c=a(25),d=a(9),u=a(1),m=a(2),p=a(3),h=a(4),v=a(26),_=a.n(v),f=a(27),g=a.n(f).a.create({baseURL:"https://praktikum.tk/cohort8",headers:{authorization:"7563ceef-3fab-429e-abe8-149027f36882","Content-Type":"application/json"}}),y=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).el=document.createElement("div"),e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){document.body.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.el)}},{key:"render",value:function(){return i.a.createPortal(this.props.children,this.el)}}]),a}(o.a.PureComponent),C=a(6),k=a.n(C),b=a(28),I=a.n(b),M=a(14),E=a.n(M),j=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=[E.a.Form,E.a[this.props.type]];return o.a.createElement("form",{onSubmit:this.props.onSubmit,className:e.join(" "),name:this.props.name,style:this.props.style,noValidate:!0},this.props.children)}}]),a}(o.a.Component),L=a(12),O=a.n(L);function S(e){var t=e.valid,a=e.touched,n=e.shouldValidate;return!t&&a&&n}var w=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=[O.a.Input];return S(this.props)&&e.push(O.a.invalid),o.a.createElement("div",null,o.a.createElement("input",{onChange:this.props.onChange,className:e.join(" "),value:this.props.value,type:this.props.type,name:this.props.name,placeholder:this.props.placeholder,minLength:this.props.minLength,maxLength:this.props.maxLength,required:!0}),S(this.props)?o.a.createElement("span",{className:O.a.Error},this.props.errorMessage):null)}}]),a}(o.a.Component),A=a(10),N=a.n(A),B=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=[N.a.Button,N.a[this.props.type]];return this.props.activateLike&&e.push(N.a.ActiveLikeIcon),this.props.showDeleteIcon&&e.push(N.a.DisplayBlock),o.a.createElement("button",{onClick:this.props.onClick,className:e.join(" "),disabled:this.props.disabled},this.props.children)}}]),a}(o.a.Component),x=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={modalConfig:{},formControls:{}},e.setErrorMessage=function(e,t){return e.length<=t.minLength?"\u0414\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043e\u0442 2 \u0434\u043e 30 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432":"\u042d\u0442\u043e \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"},e.validateControl=function(e,t){var a=!0;return!t||(t.minLength&&(a=e.length>=t.minLength&&a),t.required&&(a=""!==e.trim()&&a),a)},e.handleInputChange=function(t,a){var n=Object(d.a)({},e.state.formControls),o=Object(d.a)({},n[a]);o.value=t.target.value,o.errorMessage=e.setErrorMessage(o.value,o.validation),o.valid=e.validateControl(o.value,o.validation),o.touched=!0,n[a]=o,e.setState({formControls:n})},e.renderInputs=function(){return Object.keys(e.state.formControls).map((function(t,a){var n=e.state.formControls[t];return o.a.createElement(w,{key:t+a,onChange:function(a){return e.handleInputChange(a,t)},value:n.value,type:n.type,name:n.name,placeholder:n.placeholder,errorMessage:n.errorMessage,valid:n.valid,touched:n.touched,shouldValidate:!!n.validation})}))},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){"Avatar"===this.props.typeModal&&this.setState({modalConfig:{typeModal:this.props.typeModal,nameModal:"\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",typeForm:"Avatar",nameFrom:"avatar",nameButton:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},formControls:{avatar:{value:"",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",errorMessage:"",valid:!1,touched:!1,validation:{required:!0}}}}),"Edit"===this.props.typeModal&&this.setState({modalConfig:{typeModal:this.props.typeModal,nameModal:"\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",typeForm:"Edit",nameFrom:"edit",nameButton:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},formControls:{name:{value:"",type:"text",name:"name",placeholder:"\u0418\u043c\u044f",errorMessage:"",valid:!1,touched:!1,validation:{minLength:2,maxLength:30,required:!0}},info:{value:"",type:"text",name:"info",placeholder:"\u041e \u0441\u0435\u0431\u0435",errorMessage:"",valid:!1,touched:!1,validation:{minLength:2,maxLength:30,required:!0}}}}),"Add"===this.props.typeModal&&this.setState({modalConfig:{typeModal:this.props.typeModal,nameModal:"\u043d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",typeForm:"Add",nameFrom:"add",nameButton:"+"},formControls:{name:{value:"",type:"text",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",errorMessage:"",valid:!1,touched:!1,validation:{minLength:2,maxLength:30,required:!0}},link:{value:"",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",errorMessage:"",valid:!1,touched:!1,validation:{required:!0}}}}),"Image"===this.props.typeModal&&this.setState({modalConfig:{typeModal:this.props.typeModal,backgroundImage:this.props.backgroundImage}})}},{key:"render",value:function(){var e=this.props,t=e.handleShowModal,a=e.handleSubmit,n=this.state.modalConfig,r=n.typeModal,i=n.nameModal,l=n.typeForm,s=n.nameFrom,c=n.nameButton,d=n.backgroundImage,u=[k.a.Modal,k.a[r]],m=[k.a.Content,k.a.ContentImage],p="Image"===r?{display:"none"}:null,h=this.state.formControls.valid;return o.a.createElement("div",{className:u.join(" ")},o.a.createElement("div",{className:"Image"===r?m.join(" "):k.a.Content,style:d},o.a.createElement("img",{onClick:t,src:I.a,alt:"Close",className:k.a.Close}),o.a.createElement("h3",{className:k.a.Title,style:p},i),o.a.createElement(j,{onSubmit:a,type:l,name:s,style:p},this.renderInputs(),o.a.createElement(B,{type:"Popup",disabled:h},c))))}}]),a}(o.a.Component),D=a(15),F=a.n(D),P=a(29),q=a.n(P),V=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return o.a.createElement("header",{className:F.a.Header},o.a.createElement("img",{src:q.a,alt:"Logo",className:F.a.Logo}))}}]),a}(o.a.Component),R=a(7),T=a.n(R),H=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props,t=e.userInfo,a=e.handleShowModal,n=t.avatar,r=t.name,i=t.about,l={backgroundImage:"url('".concat(n,"')")};return o.a.createElement("div",{className:T.a.Profile},o.a.createElement("div",{className:T.a.Info},o.a.createElement("div",{className:T.a.Avatar,onClick:a,style:l}),o.a.createElement("div",{className:T.a.Data},o.a.createElement("h1",{className:T.a.Name},r),o.a.createElement("p",{className:T.a.Job},i),o.a.createElement(B,{type:"Edit",onClick:a},"edit")),o.a.createElement(B,{type:"Add",onClick:a},"+")))}}]),a}(o.a.Component),J=a(30),U=a.n(J),X=a(8),W=a.n(X),Y=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={showDeleteIcon:!1,activateLike:!1,likeCounter:null},e.handleLike=function(t){var a=t.target.closest(".Card_Card__1-aIe").getAttribute("data");t.target.closest(".Button_LikeIcon__2q2NK").classList.contains("Button_ActiveLikeIcon__1dC21")?g.delete("/cards/like/".concat(a)).then((function(){return e.setState({activateLike:!1,likeCounter:e.state.likeCounter-1})})).catch((function(e){return console.log(e)})):g.put("/cards/like/".concat(a)).then((function(){return e.setState({activateLike:!0,likeCounter:e.state.likeCounter+1})})).catch((function(e){return console.log(e)}))},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.children.owner._id===this.props.myId&&this.setState({showDeleteIcon:!0}),this.props.children.likes.forEach((function(t){t._id===e.props.myId&&e.setState({activateLike:!0})})),this.setState({likeCounter:this.props.children.likes.length})}},{key:"render",value:function(){var e=this.props,t=e.handleShowModal,a=e.handleRemoveCard,n=this.props.children,r=n.link,i=n._id,l=n.name,s={backgroundImage:"url('".concat(r,"')")};return o.a.createElement("div",{className:W.a.Card,data:i},o.a.createElement("div",{onClick:t,className:W.a.Image,style:s},o.a.createElement(B,{onClick:a,type:"DeleteIcon",showDeleteIcon:this.state.showDeleteIcon})),o.a.createElement("div",{className:W.a.Description},o.a.createElement("h3",{className:W.a.Name},l),o.a.createElement("div",{className:W.a.Like},o.a.createElement(B,{onClick:this.handleLike,type:"LikeIcon",activateLike:this.state.activateLike}),o.a.createElement("span",{className:W.a.LikeCounter},this.state.likeCounter))))}}]),a}(o.a.Component),K=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props,t=e.myId,a=e.initialCards,n=e.handleShowModal,r=e.handleRemoveCard;return o.a.createElement("div",{className:U.a.CardList},a.map((function(e){return o.a.createElement(Y,{key:e._id,myId:t,handleShowModal:n,handleRemoveCard:function(t){return r(t,e._id)}},e)})))}}]),a}(o.a.Component),Q=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={myId:"24ee49f7ef633fcc99f70066",userInfo:{},initialCards:[],showModal:!1,typeModal:null,backgroundImage:null},e.handleShowModal=function(){e.setState({showModal:!e.state.showModal})},e.handleModal=function(t){if(t.target.closest(".Profile_Avatar__2gqkF")&&e.setState({typeModal:"Avatar"}),t.target.closest(".Button_Edit__2mjyM")&&e.setState({typeModal:"Edit"}),t.target.closest(".Button_Add__pQA0V")&&e.setState({typeModal:"Add"}),t.target.closest(".Card_Image__3zHVY")){var a={backgroundImage:t.target.style.backgroundImage};e.setState({typeModal:"Image",backgroundImage:a})}},e.handleSubmit=function(t){t.preventDefault();var a=t.target;return t.target.closest(".Form_Avatar__2B2kZ")&&g.patch("/users/me/avatar/",{avatar:a.elements.link.value}).then((function(){return e.setState({userInfo:Object(d.a)({},e.state.userInfo,{avatar:a.elements.link.value})})})).catch((function(e){return console.log(e)})),t.target.closest(".Form_Edit__32yl-")&&g.patch("/users/me/",{name:a.elements.name.value,about:a.elements.info.value}).then((function(){return e.setState({userInfo:Object(d.a)({},e.state.userInfo,{name:a.elements.name.value,about:a.elements.info.value})})})).catch((function(e){return console.log(e)})),t.target.closest(".Form_Add__3j5Xp")&&g.post("/cards/",{name:a.elements.name.value,link:a.elements.link.value}).then((function(t){return e.setState({initialCards:e.state.initialCards.concat(t.data)})})).catch((function(e){return console.log(e)})),e.handleShowModal()},e.handleRemoveCard=function(t,a){t.stopPropagation();var n=e.state.initialCards.filter((function(e){return e._id!==a}));g.delete("/cards/".concat(a,"/")).then((function(){return e.setState({initialCards:n})})).catch((function(e){return console.log(e)}))},e.renderModal=function(e,t,a,n){return o.a.createElement(y,null,o.a.createElement(x,{typeModal:e,backgroundImage:t,handleShowModal:a,handleSubmit:n}))},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t,a,n,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.get("/users/me/");case 3:return t=e.sent,e.next=6,g.get("/cards/");case 6:for(a=e.sent,n=[],o=0;a.data.length>o;o++)a.data[o].owner._id===this.state.myId&&n.push(a.data[o]);this.setState({userInfo:t.data,initialCards:n}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return o.a.createElement("div",{className:_.a.Layout},o.a.createElement(V,null),o.a.createElement("main",{onClick:this.handleModal},o.a.createElement(H,{userInfo:this.state.userInfo,handleShowModal:this.handleShowModal}),o.a.createElement(K,{myId:this.state.myId,initialCards:this.state.initialCards,handleShowModal:this.handleShowModal,handleRemoveCard:this.handleRemoveCard})),this.state.showModal?this.renderModal(this.state.typeModal,this.state.backgroundImage,this.handleShowModal,this.handleSubmit):null)}}]),a}(o.a.Component);function Z(){return o.a.createElement(Q,null)}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var z=o.a.createElement(Z,null);i.a.render(z,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},6:function(e,t,a){e.exports={Modal:"Modal_Modal__1tt0E",Avatar:"Modal_Avatar__1UEXm",Edit:"Modal_Edit__2XyVq",Add:"Modal_Add__K7Tq3",Image:"Modal_Image__2FfFv",Content:"Modal_Content__uy2Jx",ContentImage:"Modal_ContentImage__iQdrJ",Close:"Modal_Close__2jT8J",Title:"Modal_Title__1AtWg"}},7:function(e,t,a){e.exports={Profile:"Profile_Profile__3d3Um",Info:"Profile_Info__2i-TL",Data:"Profile_Data__1dvf4",Job:"Profile_Job__2wt8s",Name:"Profile_Name__2CKgv",Avatar:"Profile_Avatar__2gqkF"}},8:function(e,t,a){e.exports={Card:"Card_Card__1-aIe",Image:"Card_Image__3zHVY",Description:"Card_Description__FtNuI",Name:"Card_Name__2GIPN",Like:"Card_Like__1BR3H",LikeCounter:"Card_LikeCounter__1LEyD"}}},[[31,1,2]]]);
//# sourceMappingURL=main.30ac5b40.chunk.js.map
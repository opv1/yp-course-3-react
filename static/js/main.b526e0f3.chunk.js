(this["webpackJsonpmesto-yp-react"]=this["webpackJsonpmesto-yp-react"]||[]).push([[0],{12:function(e,t,n){e.exports={Header:"Header_Header__B0cCs",Logo:"Header_Logo__2eqiZ"}},13:function(e,t,n){e.exports={Form:"Form_Form__2MkP4",Avatar:"Form_Avatar__3J7h6",Edit:"Form_Edit__L33ns",Add:"Form_Add__3ITSr"}},14:function(e,t,n){e.exports={Loader:"Loader_Loader__3bFgC",Loading:"Loader_Loading__B3_qO"}},16:function(e,t,n){e.exports={Input:"Input_Input__mYnjo"}},26:function(e,t,n){e.exports={Layout:"Layout_Layout__2-JNR"}},27:function(e,t,n){e.exports={CardList:"CardList_CardList__1CVok"}},32:function(e,t,n){e.exports={Error:"Error_Error__uaR5M"}},40:function(e,t,n){},5:function(e,t,n){e.exports={Modal:"Modal_Modal__p8Si2",Avatar:"Modal_Avatar__MNHDO",Edit:"Modal_Edit__25V6F",Add:"Modal_Add__2io38",Image:"Modal_Image__1-or_",Content:"Modal_Content__Uvhe_",ContentImage:"Modal_ContentImage__2It1l",Close:"Modal_Close__OxXGw",Title:"Modal_Title__6Ftsb"}},6:function(e,t,n){e.exports={Profile:"Profile_Profile__1Jps2",Info:"Profile_Info__1-Cv7",Data:"Profile_Data__1RWws",Job:"Profile_Job__3e2EN",Name:"Profile_Name__3EPoV",Avatar:"Profile_Avatar__S2pt1"}},61:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n(2),r=n.n(o),c=n(10),i=n.n(c),l=(n(40),Object(o.createContext)()),s=n(26),u=n.n(s);var d=function(e){var t=e.children;return Object(a.jsx)("div",{className:u.a.Layout,children:t})},j=n(12),m=n.n(j),f=n.p+"static/media/logo.fad4f8a5.svg";var b=function(){return Object(a.jsx)("header",{className:m.a.Header,children:Object(a.jsx)("img",{src:f,alt:"Logo",className:m.a.Logo})})},_=n(6),v=n.n(_),O=n(9),p=n.n(O),h=function(e){var t=e.onClick,n=e.type,o=e.disabled,r=e.activateLike,c=e.id,i=e.showDeleteIcon,l=e.children,s=[p.a.Button,p.a[n],"Button_".concat(n)];return o&&s.push(p.a.Disabled),r&&s.push("".concat(p.a.ActiveLikeIcon," Button_ActiveLikeIcon__").concat(c)),i&&s.push(p.a.DisplayBlock),Object(a.jsx)("button",{onClick:t,className:s.join(" "),name:"button",disabled:o,children:l})};var g=function(){var e=Object(o.useContext)(l),t=e.userInfo,n=e.toggleModal,r={backgroundImage:"url('".concat(t.avatar,"')")};return Object(a.jsx)("div",{className:v.a.Profile,children:Object(a.jsxs)("div",{className:v.a.Info,children:[Object(a.jsx)("div",{onClick:n,className:"".concat(v.a.Avatar," Profile_Avatar"),style:r}),Object(a.jsxs)("div",{className:v.a.Data,children:[Object(a.jsx)("h1",{className:v.a.Name,children:t.name}),Object(a.jsx)("p",{className:v.a.Job,children:t.about}),Object(a.jsx)(h,{onClick:n,type:"Edit",children:"edit"})]}),Object(a.jsx)(h,{onClick:n,type:"Add",children:"+"})]})})},C=n(27),x=n.n(C),y=n(1),I=n(8),L=n(7),k=n.n(L),M=n(28),A=n.n(M).a.create({baseURL:"https://nomoreparties.co/cohort8",headers:{authorization:"7563ceef-3fab-429e-abe8-149027f36882","Content-Type":"application/json"}});var D=function(e){var t=e.children,n=Object(o.useState)({showDeleteIcon:!1,activateLike:!1,likeCounter:null}),r=Object(I.a)(n,2),c=r[0],i=r[1],s=Object(o.useContext)(l),u=s.myId,d=s.toggleModal,j=s.removeCard;Object(o.useEffect)((function(){t.owner._id===u&&i((function(e){return Object(y.a)(Object(y.a)({},e),{},{showDeleteIcon:!0})})),t.likes.forEach((function(e){e._id===u&&i((function(e){return Object(y.a)(Object(y.a)({},e),{},{activateLike:!0})}))})),i((function(e){return Object(y.a)(Object(y.a)({},e),{},{likeCounter:t.likes.length})}))}),[]);var m={backgroundImage:"url('".concat(t.link,"')")};return Object(a.jsxs)("div",{className:"".concat(k.a.Card," Card_Card"),data:t._id,children:[Object(a.jsx)("div",{onClick:d,className:"".concat(k.a.Image," Card_Image"),style:m,children:Object(a.jsx)(h,{onClick:function(e){return j(e,t._id)},type:"DeleteIcon",showDeleteIcon:c.showDeleteIcon})}),Object(a.jsxs)("div",{className:k.a.Description,children:[Object(a.jsx)("h3",{className:k.a.Name,children:t.name}),Object(a.jsxs)("div",{className:k.a.Like,children:[Object(a.jsx)(h,{onClick:function(e){return function(e){var n=e.target.closest(".Card_Card").getAttribute("data");e.target.closest(".Button_LikeIcon").classList.contains("Button_ActiveLikeIcon__".concat(t._id))?A.delete("/cards/like/".concat(n)).then((function(){return i((function(e){return Object(y.a)(Object(y.a)({},e),{},{activateLike:!1,likeCounter:e.likeCounter-1})}))})).catch((function(e){return console.log(e)})):A.put("/cards/like/".concat(n)).then((function(){return i((function(e){return Object(y.a)(Object(y.a)({},e),{},{activateLike:!0,likeCounter:e.likeCounter+1})}))})).catch((function(e){return console.log(e)}))}(e)},type:"LikeIcon",activateLike:c.activateLike,id:t._id}),Object(a.jsx)("span",{className:k.a.LikeCounter,children:c.likeCounter})]})]})]})};var N=function(){var e=Object(o.useContext)(l).initialCards;return Object(a.jsx)("div",{className:x.a.CardList,children:e.map((function(e){return Object(a.jsx)(D,{children:e},e._id)}))})},E=n(5),F=n.n(E),w=n.p+"static/media/close.8a65f75d.svg",B=n(13),P=n.n(B),T=function(e){var t=e.onSubmit,n=e.type,o=e.name,r=e.style,c=e.children,i=[P.a.Form,P.a[n],"Form_".concat(n)];return Object(a.jsx)("form",{onSubmit:t,className:i.join(" "),name:o,style:r,noValidate:!0,children:c})},V=Object(o.createContext)();var R=function(){var e=Object(o.useContext)(l),t=e.userInfo,n=e.typeModal,r=e.openImage,c=e.updateData,i=e.toggleModal,s=Object(o.useContext)(V),u=s.configModal,d=s.isFormValid,j=s.setConfig,m=s.renderInputs;Object(o.useEffect)((function(){"Edit"===n?j(n,t):j(n)}),[]);var f=[F.a.Modal,F.a[n]];return Object(a.jsx)("div",{className:f.join(" "),children:Object(a.jsxs)("div",{className:"Image"===n?(F.a.Content,F.a.ContentImage):F.a.Content,style:"Image"===n?r:null,children:[Object(a.jsx)("img",{onClick:i,src:w,alt:"Close",className:F.a.Close}),Object(a.jsx)("h3",{className:F.a.Title,style:"Image"===n?{display:"none"}:null,children:u.nameModal}),Object(a.jsxs)(T,{onSubmit:c,type:u.typeForm,name:u.nameFrom,style:"Image"===n?{display:"none"}:null,children:[m(),Object(a.jsx)(h,{type:"Popup",disabled:!d,children:u.nameButton})]})]})})},U=n(14),q=n.n(U),J=function(){return Object(a.jsx)("div",{className:q.a.Loader,children:Object(a.jsxs)("div",{className:q.a.Loading,children:[Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{})]})})},S=n(29),H=n(30),G=n(34),K=n(33),W=function(e){Object(G.a)(n,e);var t=Object(K.a)(n);function n(){var e;Object(S.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).el=document.createElement("div"),e}return Object(H.a)(n,[{key:"componentDidMount",value:function(){document.body.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.el)}},{key:"render",value:function(){return i.a.createPortal(this.props.children,this.el)}}]),n}(r.a.Component);var z,X,Z=function(){var e=Object(o.useContext)(l),t=e.loading,n=e.showModal,r=e.initialData,c=e.setModal;return Object(o.useEffect)((function(){r()}),[]),Object(a.jsxs)(d,{children:[Object(a.jsx)(b,{}),t?Object(a.jsx)(J,{}):Object(a.jsxs)("main",{onClick:function(e){return c(e)},children:[Object(a.jsx)(g,{}),Object(a.jsx)(N,{})]}),n?Object(a.jsx)(W,{children:Object(a.jsx)(R,{})}):null]})},Q=n(15),Y=n.n(Q),$=n(31),ee=n(3),te="INITIAL_DATA",ne="TOGGLE_MODAL",ae="SET_MODAL",oe="AVATAR_UPDATE",re="INFO_UPDATE",ce="CARDS_UPDATE",ie="REMOVE_CARD",le="AVATAR_MODAL",se="EDIT_MODAL",ue="ADD_MODAL",de="VALIDATE_FORM",je="INPUT_CHANGE",me=(z={},Object(ee.a)(z,te,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{loading:!1,userInfo:t.userInfo,initialCards:t.initialCards})})),Object(ee.a)(z,ne,(function(e){return Object(y.a)(Object(y.a)({},e),{},{showModal:!e.showModal})})),Object(ee.a)(z,ae,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{typeModal:t.typeModal,openImage:t.openImage})})),Object(ee.a)(z,oe,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{userInfo:t.userInfo})})),Object(ee.a)(z,re,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{userInfo:t.userInfo})})),Object(ee.a)(z,ce,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{initialCards:t.initialCards})})),Object(ee.a)(z,ie,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{initialCards:t.initialCards})})),Object(ee.a)(z,"DEFAULT",(function(e){return e})),z),fe=function(e,t){return(me[t.type]||me.DEFAULT)(e,t)},be=function(e){var t=e.children,n=Object(o.useReducer)(fe,{loading:!0,showModal:!1,myId:"24ee49f7ef633fcc99f70066",userInfo:{},initialCards:[],typeModal:null,openImage:null}),r=Object(I.a)(n,2),c=r[0],i=r[1],s=function(){var e=Object($.a)(Y.a.mark((function e(){var t,n,a,o;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.get("/users/me/");case 2:return t=e.sent,e.next=5,A.get("/cards/");case 5:for(n=e.sent,a=[],o=0;n.data.length>o;o++)n.data[o].owner._id===c.myId&&a.push(n.data[o]);i({type:te,userInfo:t.data,initialCards:a});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){i({type:ne})},d=c.loading,j=c.showModal,m=c.myId,f=c.userInfo,b=c.initialCards,_=c.typeModal,v=c.openImage;return Object(a.jsx)(l.Provider,{value:{loading:d,showModal:j,myId:m,userInfo:f,initialCards:b,typeModal:_,openImage:v,initialData:s,toggleModal:u,setModal:function(e){if(e.target.closest(".Profile_Avatar")&&i({type:ae,typeModal:"Avatar"}),e.target.closest(".Button_Edit")&&i({type:ae,typeModal:"Edit"}),e.target.closest(".Button_Add")&&i({type:ae,typeModal:"Add"}),e.target.closest(".Card_Image")){var t={backgroundImage:e.target.style.backgroundImage};i({type:ae,typeModal:"Image",openImage:t})}},updateData:function(e){e.preventDefault();var t=e.target,n=t.elements.button;e.target.closest(".Form_Avatar")&&new Promise((function(e){n.textContent="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",e(A.patch("/users/me/avatar/",{avatar:t.elements.link.value}))})).then((function(){return i({type:oe,userInfo:Object(y.a)(Object(y.a)({},c.userInfo),{},{avatar:t.elements.link.value})})})).then((function(){return u()})).catch((function(e){return console.log(e)}));e.target.closest(".Form_Edit")&&new Promise((function(e){n.textContent="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",e(A.patch("/users/me/",{name:t.elements.name.value,about:t.elements.info.value}))})).then((function(){return i({type:re,userInfo:Object(y.a)(Object(y.a)({},c.userInfo),{},{name:t.elements.name.value,about:t.elements.info.value})})})).then((function(){return u()})).catch((function(e){return console.log(e)}));e.target.closest(".Form_Add")&&new Promise((function(e){n.textContent="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",e(A.post("/cards/",{name:t.elements.name.value,link:t.elements.link.value}))})).then((function(e){return i({type:ce,initialCards:c.initialCards.concat(e.data)})})).then((function(){return u()})).catch((function(e){return console.log(e)}))},removeCard:function(e,t){e.stopPropagation();var n=b.filter((function(e){return e._id!==t}));A.delete("/cards/".concat(t,"/")).then((function(){return i({type:ie,initialCards:n})})).catch((function(e){return console.log(e)}))}},children:t})},_e=function(e){return e.children},ve=n(16),Oe=n.n(ve),pe=function(e){var t=e.onChange,n=e.value,o=e.type,r=e.name,c=e.placeholder,i=e.valid,l=e.validation,s=[Oe.a.Input];return i||s.push(Oe.a.invalid),Object(a.jsx)("input",{onChange:t,className:s.join(" "),value:n,type:o,name:r,placeholder:c,minLength:l.minLength,maxLength:l.maxLength,required:!0})},he=n(32),ge=n.n(he),Ce=function(e){var t=e.errorMessage;return Object(a.jsx)("span",{className:ge.a.Error,children:t})},xe=n(17),ye=n.n(xe);function Ie(e,t){return Object(y.a)(Object(y.a)({},e),{},{touched:!1,validation:t,valid:ke(e.value,t),errorMessage:Me(e.value,t,!1)})}function Le(e){var t=!0;for(var n in e)e.hasOwnProperty(n)&&(t=e[n].valid&&t);return t}function ke(e,t){if(!t)return!0;var n=!0;return t.required&&(n=""!==e.trim()&&n),t.minLength&&(n=e.length>=t.minLength&&n),t.url&&(n=ye.a.url(e)&&n),n}function Me(e,t,n){return n?0===e.length?"\u042d\u0442\u043e \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435":e.length<t.minLength?"\u0414\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043e\u0442 2 \u0434\u043e 30 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432":!ye.a.url(e)&&"\u0417\u0434\u0435\u0441\u044c \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0430":""}var Ae=(X={},Object(ee.a)(X,le,(function(e){return Object(y.a)(Object(y.a)({},e),{},{configModal:{nameModal:"\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",typeForm:"Avatar",nameFrom:"avatar",nameButton:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},formControls:{avatar:Ie({value:"",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440"},{url:!0,required:!0})}})})),Object(ee.a)(X,se,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{configModal:{nameModal:"\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",typeForm:"Edit",nameFrom:"edit",nameButton:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},formControls:{name:Ie({value:t.userInfo.name,type:"text",name:"name",placeholder:"\u0418\u043c\u044f"},{minLength:2,maxLength:30,required:!0}),info:Ie({value:t.userInfo.about,type:"text",name:"info",placeholder:"\u041e \u0441\u0435\u0431\u0435"},{minLength:2,maxLength:30,required:!0})}})})),Object(ee.a)(X,ue,(function(e){return Object(y.a)(Object(y.a)({},e),{},{configModal:{nameModal:"\u043d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",typeForm:"Add",nameFrom:"add",nameButton:"+"},formControls:{name:Ie({value:"",type:"text",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"},{minLength:2,maxLength:30,required:!0}),link:Ie({value:"",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"},{url:!0,required:!0})}})})),Object(ee.a)(X,de,(function(e){return Object(y.a)(Object(y.a)({},e),{},{isFormValid:Le(e.formControls)})})),Object(ee.a)(X,je,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{formControls:t.formControls,isFormValid:t.isFormValid})})),Object(ee.a)(X,"DEFAULT",(function(e){return e})),X),De=function(e,t){return(Ae[t.type]||Ae.DEFAULT)(e,t)},Ne=function(e){var t=e.children,n=Object(o.useReducer)(De,{configModal:{},formControls:{},isFormValid:!1}),r=Object(I.a)(n,2),c=r[0],i=r[1],l=c.configModal,s=c.formControls,u=c.isFormValid;return Object(a.jsx)(V.Provider,{value:{configModal:l,formControls:s,isFormValid:u,setConfig:function(e,t){"Avatar"===e&&(i({type:le}),i({type:de})),"Edit"===e&&(i({type:se,userInfo:t}),i({type:de})),"Add"===e&&(i({type:ue}),i({type:de}))},renderInputs:function(){return Object.keys(c.formControls).map((function(e,t){var n=c.formControls[e];return Object(a.jsxs)(_e,{children:[Object(a.jsx)(pe,{onChange:function(t){return function(e,t){var n=Object(y.a)({},c.formControls),a=Object(y.a)({},n[t]);a.value=e.target.value,a.touched=!0,a.valid=ke(a.value,a.validation),a.errorMessage=Me(a.value,a.validation,a.touched),n[t]=a;var o=Le(n);i({type:je,formControls:n,isFormValid:o})}(t,e)},value:n.value,type:n.type,name:n.name,placeholder:n.placeholder,valid:n.valid,validation:n.validation}),n.valid?null:Object(a.jsx)(Ce,{errorMessage:n.errorMessage})]},t+1)}))}},children:t})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ee=Object(a.jsx)(be,{children:Object(a.jsx)(Ne,{children:Object(a.jsx)(Z,{})})});i.a.render(Ee,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,n){e.exports={Card:"Card_Card__1Kl9c",Image:"Card_Image__ezpm2",Description:"Card_Description__2gJ17",Name:"Card_Name__xBIhc",Like:"Card_Like__2akxi",LikeCounter:"Card_LikeCounter__2vI5H"}},9:function(e,t,n){e.exports={Button:"Button_Button__fDo2y",Edit:"Button_Edit__1lLdh",Add:"Button_Add__289PC",Popup:"Button_Popup__1ioXl",DeleteIcon:"Button_DeleteIcon__1nKow",LikeIcon:"Button_LikeIcon__2C4vK",ActiveLikeIcon:"Button_ActiveLikeIcon__1Z8hN",Disabled:"Button_Disabled__2nVsQ",DisplayBlock:"Button_DisplayBlock__9K_zL"}}},[[61,1,2]]]);
//# sourceMappingURL=main.b526e0f3.chunk.js.map
(this["webpackJsonpyp-course-3-react"]=this["webpackJsonpyp-course-3-react"]||[]).push([[0],[,,,,,,,function(e,t,a){e.exports={Modal:"Modal_Modal__3rlzY",Avatar:"Modal_Avatar__2ZnfD",Edit:"Modal_Edit__21zij",Add:"Modal_Add__CJUPK",Image:"Modal_Image__3j_hZ",Content:"Modal_Content__oz8Ki",ContentImage:"Modal_ContentImage__25Si7",Close:"Modal_Close__2oB51",Title:"Modal_Title__2814I"}},function(e,t,a){e.exports={Profile:"Profile_Profile__3d3Um",Info:"Profile_Info__2i-TL",Data:"Profile_Data__1dvf4",Job:"Profile_Job__2wt8s",Name:"Profile_Name__2CKgv",Avatar:"Profile_Avatar__2gqkF"}},function(e,t,a){e.exports={Card:"Card_Card__1-aIe",Image:"Card_Image__3zHVY",Description:"Card_Description__FtNuI",Name:"Card_Name__2GIPN",Like:"Card_Like__1BR3H",LikeCounter:"Card_LikeCounter__1LEyD"}},function(e,t,a){e.exports={Button:"Button_Button__ZCo3y",Edit:"Button_Edit__2mjyM",Add:"Button_Add__pQA0V",Popup:"Button_Popup__1lTX4",DeleteIcon:"Button_DeleteIcon__Cx1UT",LikeIcon:"Button_LikeIcon__2q2NK",ActiveLikeIcon:"Button_ActiveLikeIcon__1dC21",Disabled:"Button_Disabled__QrPOn",DisplayBlock:"Button_DisplayBlock__6ZmXd"}},,,function(e,t,a){e.exports={Header:"Header_Header__1e_0U",Logo:"Header_Logo__NfVY3"}},function(e,t,a){e.exports={Form:"Form_Form__3yARy",Avatar:"Form_Avatar__2B2kZ",Edit:"Form_Edit__32yl-",Add:"Form_Add__3j5Xp"}},function(e,t,a){e.exports={Input:"Input_Input__3F9VC"}},,function(e,t,a){e.exports={Loader:"Loader_Loader__3BDOx",Loading:"Loader_Loading__ROe3I"}},,,,,,,,,,,,function(e,t,a){e.exports={Layout:"Layout_Layout__mSfzk"}},function(e,t,a){e.exports=a.p+"static/media/logo.aa3e7ad2.svg"},function(e,t,a){e.exports={CardList:"CardList_CardList__2XYjU"}},function(e,t,a){e.exports=a.p+"static/media/close.41450a58.svg"},function(e,t,a){e.exports={Error:"Error_Error__3ieBZ"}},function(e,t,a){e.exports=a(59)},,,,,,function(e,t,a){},,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(11),l=a.n(r),i=a(12),c=a.n(i),s=a(27),d=a(6),u=a(1),m=a(2),h=a(4),p=a(3),_=(a(40),a(28)),f=a.n(_).a.create({baseURL:"https://praktikum.tk/cohort8",headers:{authorization:"7563ceef-3fab-429e-abe8-149027f36882","Content-Type":"application/json"}}),v=a(29),g=a.n(v),y=function(e){return o.a.createElement("div",{className:g.a.Layout},e.children)},C=a(13),k=a.n(C),b=a(30),I=a.n(b),E=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return o.a.createElement("header",{className:k.a.Header},o.a.createElement("img",{src:I.a,alt:"Logo",className:k.a.Logo}))}}]),a}(n.Component),M=a(8),L=a.n(M),j=a(10),w=a.n(j),S=function(e){var t=e.onClick,a=e.type,n=e.disabled,r=e.activateLike,l=e.showDeleteIcon,i=[w.a.Button,w.a[a]];return n&&i.push(w.a.Disabled),r&&i.push(w.a.ActiveLikeIcon),l&&i.push(w.a.DisplayBlock),o.a.createElement("button",{onClick:t,className:i.join(" "),name:"button",disabled:n},e.children)},O=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props,t=e.userInfo,a=e.handleShowModal,n=t.avatar,r=t.name,l=t.about,i={backgroundImage:"url('".concat(n,"')")};return o.a.createElement("div",{className:L.a.Profile},o.a.createElement("div",{className:L.a.Info},o.a.createElement("div",{className:L.a.Avatar,onClick:a,style:i}),o.a.createElement("div",{className:L.a.Data},o.a.createElement("h1",{className:L.a.Name},r),o.a.createElement("p",{className:L.a.Job},l),o.a.createElement(S,{type:"Edit",onClick:a},"edit")),o.a.createElement(S,{type:"Add",onClick:a},"+")))}}]),a}(n.Component),N=a(31),A=a.n(N),x=a(9),B=a.n(x),D=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={showDeleteIcon:!1,activateLike:!1,likeCounter:null},e.handleLike=function(t){var a=t.target.closest(".Card_Card__1-aIe").getAttribute("data");t.target.closest(".Button_LikeIcon__2q2NK").classList.contains("Button_ActiveLikeIcon__1dC21")?f.delete("/cards/like/".concat(a)).then((function(){return e.setState((function(e){return{activateLike:!1,likeCounter:e.likeCounter-1}}))})).catch((function(e){return console.log(e)})):f.put("/cards/like/".concat(a)).then((function(){return e.setState((function(e){return{activateLike:!0,likeCounter:e.likeCounter+1}}))})).catch((function(e){return console.log(e)}))},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.children.owner._id===this.props.myId&&this.setState({showDeleteIcon:!0}),this.props.children.likes.forEach((function(t){t._id===e.props.myId&&e.setState({activateLike:!0})})),this.setState({likeCounter:this.props.children.likes.length})}},{key:"render",value:function(){var e=this.props,t=e.handleShowModal,a=e.handleRemoveCard,n=this.props.children,r=n.link,l=n._id,i=n.name,c={backgroundImage:"url('".concat(r,"')")};return o.a.createElement("div",{className:B.a.Card,data:l},o.a.createElement("div",{onClick:t,className:B.a.Image,style:c},o.a.createElement(S,{onClick:a,type:"DeleteIcon",showDeleteIcon:this.state.showDeleteIcon})),o.a.createElement("div",{className:B.a.Description},o.a.createElement("h3",{className:B.a.Name},i),o.a.createElement("div",{className:B.a.Like},o.a.createElement(S,{onClick:this.handleLike,type:"LikeIcon",activateLike:this.state.activateLike}),o.a.createElement("span",{className:B.a.LikeCounter},this.state.likeCounter))))}}]),a}(n.Component),F=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props,t=e.myId,a=e.initialCards,n=e.handleShowModal,r=e.handleRemoveCard;return o.a.createElement("div",{className:A.a.CardList},a.map((function(e){return o.a.createElement(D,{key:e._id,myId:t,handleShowModal:n,handleRemoveCard:function(t){return r(t,e._id)}},e)})))}}]),a}(n.Component),P=a(7),R=a.n(P),q=a(32),V=a.n(q),z=function(e){return e.children},H=a(14),T=a.n(H),U=function(e){var t=e.onSubmit,a=e.type,n=e.name,r=e.style,l=[T.a.Form,T.a[a]];return o.a.createElement("form",{onSubmit:t,className:l.join(" "),name:n,style:r,noValidate:!0},e.children)},Y=a(15),Z=a.n(Y),J=function(e){var t=e.onChange,a=e.value,n=e.type,r=e.name,l=e.placeholder,i=e.valid,c=e.validation,s=[Z.a.Input];return i||s.push(Z.a.invalid),o.a.createElement("input",{onChange:t,className:s.join(" "),value:a,type:n||"text",name:r,placeholder:l,minLength:c.minLength,maxLength:c.maxLength,required:!0})},K=a(33),X=a.n(K),Q=function(e){var t=e.errorMessage;return o.a.createElement("span",{className:X.a.Error},t)},W=a(16),G=a.n(W);function $(e,t){return Object(d.a)(Object(d.a)({},e),{},{touched:!1,validation:t,valid:te(e.value,t),errorMessage:ae(e.value,t,!0)})}function ee(e){var t=!0;for(var a in e)e.hasOwnProperty(a)&&(t=e[a].valid&&t);return t}function te(e,t){if(!t)return!0;var a=!0;return t.required&&(a=""!==e.trim()&&a),t.minLength&&(a=e.length>=t.minLength&&a),t.url&&(a=G.a.url(e)&&a),a}function ae(e,t,a){return a?"":0===e.length?"\u042d\u0442\u043e \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435":e.length<t.minLength?"\u0414\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043e\u0442 2 \u0434\u043e 30 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432":!G.a.url(e)&&"\u0417\u0434\u0435\u0441\u044c \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0430"}var ne=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={modalConfig:{},formControls:{},isFormValid:!1},e.handleClick=function(e,t){return!!e.target.classList.contains("Modal_Modal__3rlzY")&&t()},e.handleChange=function(t,a){var n=Object(d.a)({},e.state.formControls),o=Object(d.a)({},n[a]);o.value=t.target.value,o.touched=!0,o.valid=te(o.value,o.validation),o.errorMessage=ae(o.value,o.validation),n[a]=o;var r=ee(n);e.setState({formControls:n,isFormValid:r})},e.handleRenderInputs=function(){return Object.keys(e.state.formControls).map((function(t,a){var n=e.state.formControls[t];return o.a.createElement(z,{key:a+1},o.a.createElement(J,{onChange:function(a){return e.handleChange(a,t)},value:n.value,type:n.type,name:n.name,placeholder:n.placeholder,valid:n.valid,validation:n.validation}),n.valid?null:o.a.createElement(Q,{errorMessage:n.errorMessage}))}))},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){return"Avatar"===this.props.typeModal?this.setState({modalConfig:{typeModal:this.props.typeModal,nameModal:"\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",typeForm:"Avatar",nameFrom:"avatar",nameButton:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},formControls:{avatar:$({value:"",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440"},{url:!0,required:!0})}}):"Edit"===this.props.typeModal?this.setState({modalConfig:{typeModal:this.props.typeModal,nameModal:"\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",typeForm:"Edit",nameFrom:"edit",nameButton:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},formControls:{name:$({value:this.props.userInfo.name,type:"text",name:"name",placeholder:"\u0418\u043c\u044f"},{minLength:2,maxLength:30,required:!0}),info:$({value:this.props.userInfo.about,type:"text",name:"info",placeholder:"\u041e \u0441\u0435\u0431\u0435"},{minLength:2,maxLength:30,required:!0})},isFormValid:ee(this.state.formControls)}):"Add"===this.props.typeModal?this.setState({modalConfig:{typeModal:this.props.typeModal,nameModal:"\u043d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",typeForm:"Add",nameFrom:"add",nameButton:"+"},formControls:{name:$({value:"",type:"text",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"},{minLength:2,maxLength:30,required:!0}),link:$({value:"",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"},{url:!0,required:!0})}}):"Image"===this.props.typeModal&&this.setState({modalConfig:{typeModal:this.props.typeModal,backgroundImage:this.props.backgroundImage}})}},{key:"render",value:function(){var e=this.props,t=e.handleShowModal,a=e.handleSubmit,n=this.state.modalConfig,r=n.typeModal,l=n.nameModal,i=n.typeForm,c=n.nameFrom,s=n.nameButton,d=n.backgroundImage,u=[R.a.Modal,R.a[r]];return o.a.createElement("div",{className:u.join(" ")},o.a.createElement("div",{className:"Image"===r?(R.a.Content,R.a.ContentImage):R.a.Content,style:d},o.a.createElement("img",{onClick:t,src:V.a,alt:"Close",className:R.a.Close}),o.a.createElement("h3",{className:R.a.Title,style:"Image"===r?{display:"none"}:null},l),o.a.createElement(U,{onSubmit:a,type:i,name:c,style:"Image"===r?{display:"none"}:null},this.handleRenderInputs(),o.a.createElement(S,{type:"Popup",disabled:!this.state.isFormValid},s))))}}]),a}(n.Component),oe=a(17),re=a.n(oe),le=function(){return o.a.createElement("div",{className:re.a.Loader},o.a.createElement("div",{className:re.a.Loading},o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null)))},ie=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).el=document.createElement("div"),e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){document.body.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.el)}},{key:"render",value:function(){return l.a.createPortal(this.props.children,this.el)}}]),a}(o.a.Component),ce=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={loading:!0,showModal:!1,myId:"24ee49f7ef633fcc99f70066",userInfo:{},initialCards:[],typeModal:null,backgroundImage:null},e.handleShowModal=function(){e.setState({showModal:!e.state.showModal})},e.handleClick=function(t){if(t.target.closest(".Profile_Avatar__2gqkF"))return e.setState({typeModal:"Avatar"});if(t.target.closest(".Button_Edit__2mjyM"))return e.setState({typeModal:"Edit"});if(t.target.closest(".Button_Add__pQA0V"))return e.setState({typeModal:"Add"});if(t.target.closest(".Card_Image__3zHVY")){var a={backgroundImage:t.target.style.backgroundImage};return e.setState({typeModal:"Image",backgroundImage:a})}return!!t.target.classList.contains("Modal_Modal__3rlzY")&&e.handleShowModal()},e.handleSubmit=function(t){t.preventDefault();var a=t.target,n=t.target.elements.button;return t.target.closest(".Form_Avatar__2B2kZ")?new Promise((function(e){n.textContent="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",e(f.patch("/users/me/avatar/",{avatar:a.elements.link.value}))})).then((function(){return e.setState({userInfo:Object(d.a)(Object(d.a)({},e.state.userInfo),{},{avatar:a.elements.link.value})})})).then((function(){return e.handleShowModal()})).catch((function(e){return console.log(e)})):t.target.closest(".Form_Edit__32yl-")?new Promise((function(e){n.textContent="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",e(f.patch("/users/me/",{name:a.elements.name.value,about:a.elements.info.value}))})).then((function(){return e.setState({userInfo:Object(d.a)(Object(d.a)({},e.state.userInfo),{},{name:a.elements.name.value,about:a.elements.info.value})})})).then((function(){return e.handleShowModal()})).catch((function(e){return console.log(e)})):!!t.target.closest(".Form_Add__3j5Xp")&&new Promise((function(e){n.textContent="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",e(f.post("/cards/",{name:a.elements.name.value,link:a.elements.link.value}))})).then((function(t){return e.setState({initialCards:e.state.initialCards.concat(t.data)})})).then((function(){return e.handleShowModal()})).catch((function(e){return console.log(e)}))},e.handleRemoveCard=function(t,a){t.stopPropagation();var n=e.state.initialCards.filter((function(e){return e._id!==a}));f.delete("/cards/".concat(a,"/")).then((function(){return e.setState({initialCards:n})})).catch((function(e){return console.log(e)}))},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=Object(s.a)(c.a.mark((function e(){var t,a,n,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.get("/users/me/");case 3:return t=e.sent,e.next=6,f.get("/cards/");case 6:for(a=e.sent,n=[],o=0;a.data.length>o;o++)a.data[o].owner._id===this.state.myId&&n.push(a.data[o]);this.setState({loading:!1,userInfo:t.data,initialCards:n}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return o.a.createElement(y,null,o.a.createElement(E,null),this.state.loading?o.a.createElement(le,null):o.a.createElement("main",{onClick:function(t){return e.handleClick(t)}},o.a.createElement(O,{userInfo:this.state.userInfo,handleShowModal:this.handleShowModal}),o.a.createElement(F,{myId:this.state.myId,initialCards:this.state.initialCards,handleShowModal:this.handleShowModal,handleRemoveCard:this.handleRemoveCard})),this.state.showModal?o.a.createElement(ie,null,o.a.createElement(ne,{userInfo:this.state.userInfo,typeModal:this.state.typeModal,backgroundImage:this.state.backgroundImage,handleShowModal:this.handleShowModal,handleSubmit:this.handleSubmit})):null)}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var se=o.a.createElement(ce,null);l.a.render(se,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[34,1,2]]]);
//# sourceMappingURL=main.02462618.chunk.js.map